<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tbilisi City Quest â€” Feedback</title>

  <style>
    body{font-family:system-ui,Arial;margin:0;background:#f6f7fb;color:#111827}
    .wrap{max-width:980px;margin:0 auto;padding:20px}
    .card{background:#fff;border-radius:16px;padding:18px;box-shadow:0 6px 24px rgba(0,0,0,.06);margin-bottom:14px}
    h1{margin:0 0 6px;font-size:22px}
    .muted{color:#667085;font-size:14px;line-height:1.45}
    h2{margin:18px 0 10px;font-size:18px}
    .qtitle{margin:0 0 6px;font-size:18px;font-weight:800}
    .qsub{margin:0 0 10px;font-size:13px;color:#667085}
    label{display:block;margin:10px 0 6px;font-weight:700}
    input[type="text"], textarea, select{
      width:100%;box-sizing:border-box;border:1px solid #d0d5dd;border-radius:12px;
      padding:10px 12px;font-size:15px;background:#fff
    }
    textarea{min-height:90px;resize:vertical}
    .options{display:flex;flex-direction:column;gap:8px;margin-top:8px}
    .opt{display:flex;gap:10px;align-items:flex-start}
    .opt input{margin-top:3px}
    .hr{height:1px;background:#eef2f6;margin:16px 0}
    .btn{
      display:inline-block;background:#111827;color:#fff;border:0;border-radius:12px;
      padding:10px 14px;font-size:15px;cursor:pointer
    }
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .ok{color:#16a34a;font-weight:800;margin-top:10px}
    .err{color:#dc2626;font-weight:800;margin-top:10px}
    .langbar{display:flex;gap:10px;align-items:center;justify-content:space-between}
    .langbtns{display:flex;gap:8px}
    .chip{
      border:1px solid #d0d5dd;background:#fff;border-radius:999px;
      padding:8px 12px;font-size:14px;cursor:pointer
    }
    .chip.active{background:#111827;color:#fff;border-color:#111827}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:760px){ .grid2{grid-template-columns:1fr} }
    a{color:#111827}
  </style>
</head>

<body>
<div class="wrap">

  <div class="card">
    <div class="langbar">
      <div>
        <h1 data-i18n="title">Tbilisi City Quest â€” Feedback</h1>
        <div class="muted" data-i18n="intro">
          Thank you for joining the quest! This feedback helps me improve the next quests.
        </div>
      </div>
      <div class="langbtns">
        <button type="button" class="chip active" id="btnEN">EN</button>
        <button type="button" class="chip" id="btnRU">RU</button>
      </div>
    </div>
    <div class="hr"></div>
    <div class="muted" data-i18n="timehint">
      This form takes ~5 minutes. Please answer honestly â€” it really helps ğŸ™Œ
    </div>
  </div>

  <form id="feedbackForm" class="card">
    <input type="hidden" name="lang" id="lang" value="en"/>
    <input type="hidden" name="device_time" id="device_time" value=""/>
    <input type="hidden" name="source_page" id="source_page" value=""/>

    <!-- 1 -->
    <div class="qtitle" data-i18n="q1_title">How did you like the Tbilisi City Quest? (1â€“10)</div>
    <div class="qsub" data-i18n="q1_sub">10 means â€œloved itâ€.</div>
    <select id="overall_10" name="overall_10" required>
      <option value="" data-i18n="select">Select</option>
      <option value="10">10</option><option value="9">9</option><option value="8">8</option><option value="7">7</option><option value="6">6</option>
      <option value="5">5</option><option value="4">4</option><option value="3">3</option><option value="2">2</option><option value="1">1</option>
    </select>

    <div class="hr"></div>

    <!-- 2 -->
    <div class="qtitle" data-i18n="q2_title">What did you like the most?</div>
    <div class="qsub" data-i18n="q2_sub">Choose all that apply.</div>
    <div class="options">
      <label class="opt"><input type="checkbox" name="liked_most_opt" value="Tasks & questions"><span data-i18n="lm1">Tasks & questions</span></label>
      <label class="opt"><input type="checkbox" name="liked_most_opt" value="Culture & history"><span data-i18n="lm2">Culture & history</span></label>
      <label class="opt"><input type="checkbox" name="liked_most_opt" value="Route & city"><span data-i18n="lm3">Route & city</span></label>
      <label class="opt"><input type="checkbox" name="liked_most_opt" value="Bonus questions"><span data-i18n="lm4">Bonus questions</span></label>
      <label class="opt"><input type="checkbox" name="liked_most_opt" value="Improv game at the hotel"><span data-i18n="lm5">Improv game at the hotel</span></label>
      <label class="opt"><input type="checkbox" name="liked_most_opt" value="Khinkali at Zodiaco"><span data-i18n="lm6">Khinkali at Zodiaco</span></label>
    </div>

    <div class="hr"></div>

    <!-- 3 -->
    <div class="qtitle" data-i18n="q3_title">What did you miss?</div>
    <div class="qsub" data-i18n="q3_sub">Which task types should we add next time? (choose any)</div>
    <div class="options">
      <label class="opt"><input type="checkbox" name="add_types_opt" value="Logic puzzles"><span data-i18n="at1">Logic puzzles</span></label>
      <label class="opt"><input type="checkbox" name="add_types_opt" value="Music contests"><span data-i18n="at2">Music contests</span></label>
      <label class="opt"><input type="checkbox" name="add_types_opt" value="Painting / draw something"><span data-i18n="at3">Painting / draw something</span></label>
      <label class="opt"><input type="checkbox" name="add_types_opt" value="Emotional / scary tasks"><span data-i18n="at4">Emotional / scary tasks</span></label>
      <label class="opt"><input type="checkbox" name="add_types_opt" value="Sport / obstacle challenges"><span data-i18n="at5">Sport / obstacle challenges</span></label>
    </div>

    <div class="hr"></div>

    <!-- 4 (multi-select as checkboxes) -->
    <div class="qtitle" data-i18n="q4_title">Were any tasks too hard or unclear?</div>
    <div class="qsub" data-i18n="q4_sub">Choose all that apply.</div>
    <div class="options">
      <label class="opt"><input type="checkbox" name="hard_tasks_opt" value="None"><span data-i18n="none">None</span></label>
      <label class="opt"><input type="checkbox" name="hard_tasks_opt" value="Task 1"><span data-i18n="ht1">Task 1</span></label>
      <label class="opt"><input type="checkbox" name="hard_tasks_opt" value="Task 2"><span data-i18n="ht2">Task 2</span></label>
      <label class="opt"><input type="checkbox" name="hard_tasks_opt" value="Task 3"><span data-i18n="ht3">Task 3</span></label>
      <label class="opt"><input type="checkbox" name="hard_tasks_opt" value="Task 4"><span data-i18n="ht4">Task 4</span></label>
      <label class="opt"><input type="checkbox" name="hard_tasks_opt" value="Task 5"><span data-i18n="ht5">Task 5</span></label>
      <label class="opt"><input type="checkbox" name="hard_tasks_opt" value="Task 6"><span data-i18n="ht6">Task 6</span></label>
      <label class="opt"><input type="checkbox" name="hard_tasks_opt" value="Task 7"><span data-i18n="ht7">Task 7</span></label>
      <label class="opt"><input type="checkbox" name="hard_tasks_opt" value="Task 8"><span data-i18n="ht8">Task 8</span></label>
      <label class="opt"><input type="checkbox" name="hard_tasks_opt" value="Task 9"><span data-i18n="ht9">Task 9</span></label>
    </div>
    <div class="qsub" data-i18n="hard_note">(You can rename â€œTask 1â€¦9â€ to real task names later.)</div>

    <div class="hr"></div>

    <!-- 5 -->
    <div class="qtitle" data-i18n="q5_title">Now rate each task</div>
    <div class="qsub" data-i18n="q5_sub">1 = did not like / 5 = loved it</div>

    <div class="grid2">
      <div>
        <label for="task1_rating" data-i18n="t1">Task 1</label>
        <select id="task1_rating" name="task1_rating">
          <option value="" data-i18n="select">Select</option>
          <option value="5">ğŸ˜ 5 â€” Loved it</option>
          <option value="4">ğŸ˜Š 4 â€” Liked it</option>
          <option value="3">ğŸ˜ 3 â€” Okay</option>
          <option value="2">ğŸ˜• 2 â€” Not great</option>
          <option value="1">ğŸ˜ 1 â€” Did not like</option>
        </select>
      </div>

      <div>
        <label for="task2_rating" data-i18n="t2">Task 2</label>
        <select id="task2_rating" name="task2_rating">
          <option value="" data-i18n="select">Select</option>
          <option value="5">ğŸ˜ 5 â€” Loved it</option>
          <option value="4">ğŸ˜Š 4 â€” Liked it</option>
          <option value="3">ğŸ˜ 3 â€” Okay</option>
          <option value="2">ğŸ˜• 2 â€” Not great</option>
          <option value="1">ğŸ˜ 1 â€” Did not like</option>
        </select>
      </div>

      <div>
        <label for="task3_rating" data-i18n="t3">Task 3</label>
        <select id="task3_rating" name="task3_rating">
          <option value="" data-i18n="select">Select</option>
          <option value="5">ğŸ˜ 5 â€” Loved it</option>
          <option value="4">ğŸ˜Š 4 â€” Liked it</option>
          <option value="3">ğŸ˜ 3 â€” Okay</option>
          <option value="2">ğŸ˜• 2 â€” Not great</option>
          <option value="1">ğŸ˜ 1 â€” Did not like</option>
        </select>
      </div>

      <div>
        <label for="task4_rating" data-i18n="t4">Task 4</label>
        <select id="task4_rating" name="task4_rating">
          <option value="" data-i18n="select">Select</option>
          <option value="5">ğŸ˜ 5 â€” Loved it</option>
          <option value="4">ğŸ˜Š 4 â€” Liked it</option>
          <option value="3">ğŸ˜ 3 â€” Okay</option>
          <option value="2">ğŸ˜• 2 â€” Not great</option>
          <option value="1">ğŸ˜ 1 â€” Did not like</option>
        </select>
      </div>

      <div>
        <label for="task5_rating" data-i18n="t5">Task 5</label>
        <select id="task5_rating" name="task5_rating">
          <option value="" data-i18n="select">Select</option>
          <option value="5">ğŸ˜ 5 â€” Loved it</option>
          <option value="4">ğŸ˜Š 4 â€” Liked it</option>
          <option value="3">ğŸ˜ 3 â€” Okay</option>
          <option value="2">ğŸ˜• 2 â€” Not great</option>
          <option value="1">ğŸ˜ 1 â€” Did not like</option>
        </select>
      </div>

      <div>
        <label for="task6_rating" data-i18n="t6">Task 6</label>
        <select id="task6_rating" name="task6_rating">
          <option value="" data-i18n="select">Select</option>
          <option value="5">ğŸ˜ 5 â€” Loved it</option>
          <option value="4">ğŸ˜Š 4 â€” Liked it</option>
          <option value="3">ğŸ˜ 3 â€” Okay</option>
          <option value="2">ğŸ˜• 2 â€” Not great</option>
          <option value="1">ğŸ˜ 1 â€” Did not like</option>
        </select>
      </div>

      <div>
        <label for="task7_rating" data-i18n="t7">Task 7</label>
        <select id="task7_rating" name="task7_rating">
          <option value="" data-i18n="select">Select</option>
          <option value="5">ğŸ˜ 5 â€” Loved it</option>
          <option value="4">ğŸ˜Š 4 â€” Liked it</option>
          <option value="3">ğŸ˜ 3 â€” Okay</option>
          <option value="2">ğŸ˜• 2 â€” Not great</option>
          <option value="1">ğŸ˜ 1 â€” Did not like</option>
        </select>
      </div>

      <div>
        <label for="task8_rating" data-i18n="t8">Task 8</label>
        <select id="task8_rating" name="task8_rating">
          <option value="" data-i18n="select">Select</option>
          <option value="5">ğŸ˜ 5 â€” Loved it</option>
          <option value="4">ğŸ˜Š 4 â€” Liked it</option>
          <option value="3">ğŸ˜ 3 â€” Okay</option>
          <option value="2">ğŸ˜• 2 â€” Not great</option>
          <option value="1">ğŸ˜ 1 â€” Did not like</option>
        </select>
      </div>

      <div>
        <label for="task9_rating" data-i18n="t9">Task 9</label>
        <select id="task9_rating" name="task9_rating">
          <option value="" data-i18n="select">Select</option>
          <option value="5">ğŸ˜ 5 â€” Loved it</option>
          <option value="4">ğŸ˜Š 4 â€” Liked it</option>
          <option value="3">ğŸ˜ 3 â€” Okay</option>
          <option value="2">ğŸ˜• 2 â€” Not great</option>
          <option value="1">ğŸ˜ 1 â€” Did not like</option>
        </select>
      </div>
    </div>

    <div class="hr"></div>

    <!-- 6 -->
    <div class="qtitle" data-i18n="q6_title">Did you feel tired or lose focus at any point?</div>
    <select id="fatigue" name="fatigue">
      <option value="" data-i18n="select">Select</option>
      <option value="No â€” it stayed dynamic" data-i18n="fa1">No â€” it stayed dynamic</option>
      <option value="Yes â€” around the middle" data-i18n="fa2">Yes â€” around the middle</option>
      <option value="Yes â€” closer to the end" data-i18n="fa3">Yes â€” closer to the end</option>
    </select>

    <div class="hr"></div>

    <!-- 7 -->
    <div class="qtitle" data-i18n="q7_title">Your favorite moment of the quest</div>
    <textarea id="favorite_moment" name="favorite_moment" data-i18n-ph="ph_fav"
      placeholder="A specific scene, a funny moment, a place, a task, anything."></textarea>

    <div class="hr"></div>

    <!-- 8 -->
    <div class="qtitle" data-i18n="q8_title">What should we improve or add next time?</div>
    <textarea id="improve" name="improve" data-i18n-ph="ph_improve"
      placeholder="Be brutally honest â€” this is the most valuable field ğŸ™‚"></textarea>

    <div class="hr"></div>

    <!-- 9 -->
    <div class="qtitle" data-i18n="q9_title">Public review (anonymous)</div>
    <div class="muted" data-i18n="pub_note">
      Questions 1â€“8 are for internal improvement. Question 9 is separate: an anonymous review we may publish.
    </div>
    <label for="public_review" data-i18n="q_public">Write a short honest review for publication</label>
    <textarea id="public_review" name="public_review" data-i18n-ph="ph_public"
      placeholder="Write a general review so other people can understand the impression of the quest."></textarea>

    <div class="hr"></div>

    <button class="btn" id="submitBtn" type="submit" data-i18n="send">Send feedback</button>
    <div id="msg"></div>
  </form>
</div>

<script type="module">
  import { API_URL } from './config.js';

  const form = document.getElementById('feedbackForm');
  const msg = document.getElementById('msg');
  const btn = document.getElementById('submitBtn');
  const langInput = document.getElementById('lang');

  document.getElementById('device_time').value = new Date().toISOString();
  document.getElementById('source_page').value = location.href;

  function collectChecked(name) {
    return Array.from(form.querySelectorAll(`input[name="${name}"]:checked`))
      .map(n => n.value)
      .join("; ");
  }

  const dict = {
    en: {
      title: "Tbilisi City Quest â€” Feedback",
      intro: "Thank you for joining the quest! This feedback helps me improve the next quests.",
      timehint: "This form takes ~5 minutes. Please answer honestly â€” it really helps ğŸ™Œ",
      select: "Select",
      none: "None",

      q1_title: "How did you like the Tbilisi City Quest? (1â€“10)",
      q1_sub: "10 means â€œloved itâ€.",

      q2_title: "What did you like the most?",
      q2_sub: "Choose all that apply.",
      lm1: "Tasks & questions",
      lm2: "Culture & history",
      lm3: "Route & city",
      lm4: "Bonus questions",
      lm5: "Improv game at the hotel",
      lm6: "Khinkali at Zodiaco",

      q3_title: "What did you miss?",
      q3_sub: "Which task types should we add next time? (choose any)",
      at1: "Logic puzzles",
      at2: "Music contests",
      at3: "Painting / draw something",
      at4: "Emotional / scary tasks",
      at5: "Sport / obstacle challenges",

      q4_title: "Were any tasks too hard or unclear?",
      q4_sub: "Choose all that apply.",
      ht1: "Task 1",
      ht2: "Task 2",
      ht3: "Task 3",
      ht4: "Task 4",
      ht5: "Task 5",
      ht6: "Task 6",
      ht7: "Task 7",
      ht8: "Task 8",
      ht9: "Task 9",
      hard_note: "(You can rename â€œTask 1â€¦9â€ to real task names later.)",

      q5_title: "Now rate each task",
      q5_sub: "1 = did not like / 5 = loved it",
      t1: "Task 1",
      t2: "Task 2",
      t3: "Task 3",
      t4: "Task 4",
      t5: "Task 5",
      t6: "Task 6",
      t7: "Task 7",
      t8: "Task 8",
      t9: "Task 9",

      q6_title: "Did you feel tired or lose focus at any point?",
      fa1: "No â€” it stayed dynamic",
      fa2: "Yes â€” around the middle",
      fa3: "Yes â€” closer to the end",

      q7_title: "Your favorite moment of the quest",
      ph_fav: "A specific scene, a funny moment, a place, a task, anything.",

      q8_title: "What should we improve or add next time?",
      ph_improve: "Be brutally honest â€” this is the most valuable field ğŸ™‚",

      q9_title: "Public review (anonymous)",
      pub_note: "Questions 1â€“8 are for internal improvement. Question 9 is separate: an anonymous review we may publish.",
      q_public: "Write a short honest review for publication",
      ph_public: "Write a general review so other people can understand the impression of the quest.",

      send: "Send feedback"
    },

    ru: {
      title: "Tbilisi City Quest â€” ĞĞ±Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ ÑĞ²ÑĞ·ÑŒ",
      intro: "Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾, Ñ‡Ñ‚Ğ¾ ÑƒÑ‡Ğ°ÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ğ»Ğ¸ Ğ² ĞºĞ²ĞµÑÑ‚Ğµ! Ğ­Ñ‚Ğ° Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ ÑĞ²ÑĞ·ÑŒ Ğ¿Ğ¾Ğ¼Ğ¾Ğ¶ĞµÑ‚ ÑƒĞ»ÑƒÑ‡ÑˆĞ¸Ñ‚ÑŒ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ ĞºĞ²ĞµÑÑ‚Ñ‹.",
      timehint: "Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ¹Ğ¼ĞµÑ‚ ~5 Ğ¼Ğ¸Ğ½ÑƒÑ‚. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°Ğ¹Ñ‚Ğµ Ñ‡ĞµÑÑ‚Ğ½Ğ¾ â€” ÑÑ‚Ğ¾ Ğ¾Ñ‡ĞµĞ½ÑŒ Ğ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°ĞµÑ‚ ğŸ™Œ",
      select: "Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ",
      none: "ĞĞµÑ‚",

      q1_title: "ĞšĞ°Ğº Ğ²Ğ°Ğ¼ Ğ² Ñ†ĞµĞ»Ğ¾Ğ¼ Ğ¿Ğ¾Ğ½Ñ€Ğ°Ğ²Ğ¸Ğ»ÑÑ Tbilisi City Quest? (1â€“10)",
      q1_sub: "10 â€” ÑÑ‚Ğ¾ Ğ¼Ğ°ĞºÑĞ¸Ğ¼ÑƒĞ¼, Ğ·Ğ½Ğ°Ñ‡Ğ¸Ñ‚ Ğ²Ğ°Ğ¼ Ğ¾Ñ‡ĞµĞ½ÑŒ Ğ¿Ğ¾Ğ½Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ¾ÑÑŒ.",

      q2_title: "Ğ§Ñ‚Ğ¾ Ğ¿Ğ¾Ğ½Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ¾ÑÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ²ÑĞµĞ³Ğ¾?",
      q2_sub: "ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ¾Ğ².",
      lm1: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¸ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹",
      lm2: "ĞšÑƒĞ»ÑŒÑ‚ÑƒÑ€Ğ° Ğ¸ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ",
      lm3: "ĞœĞ°Ñ€ÑˆÑ€ÑƒÑ‚ Ğ¸ Ğ³Ğ¾Ñ€Ğ¾Ğ´",
      lm4: "Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹",
      lm5: "Ğ˜Ğ¼Ğ¿Ñ€Ğ¾Ğ²Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ğ°Ñ Ğ¸Ğ³Ñ€Ğ° Ğ² Ğ¾Ñ‚ĞµĞ»Ğµ",
      lm6: "Ğ¥Ğ¸Ğ½ĞºĞ°Ğ»Ğ¸ Ğ² Zodiaco",

      q3_title: "ĞšĞ°ĞºĞ¸Ñ… Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹ Ğ²Ğ°Ğ¼ Ğ½Ğµ Ñ…Ğ²Ğ°Ñ‚Ğ¸Ğ»Ğ¾?",
      q3_sub: "ĞšĞ°ĞºĞ¸Ğµ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ñ€Ğ°Ğ·? (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾)",
      at1: "Ğ›Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸",
      at2: "ĞœÑƒĞ·Ñ‹ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğµ ĞºĞ¾Ğ½ĞºÑƒÑ€ÑÑ‹",
      at3: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ Ñ Ğ¶Ğ¸Ğ²Ğ¾Ğ¿Ğ¸ÑÑŒÑ â€” Ñ‡Ñ‚Ğ¾-Ñ‚Ğ¾ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¸Ñ‚ÑŒ",
      at4: "Ğ­Ğ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾-Ğ¿ÑƒĞ³Ğ°ÑÑ‰Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ",
      at5: "Ğ¡Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ / Ğ¿Ñ€ĞµĞ¾Ğ´Ğ¾Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ğ¹",

      q4_title: "Ğ‘Ñ‹Ğ»Ğ¸ Ğ»Ğ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ğ»Ğ¸ÑÑŒ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ğ¼Ğ¸ Ğ¸Ğ»Ğ¸ Ğ½ĞµĞ¾Ñ‡ĞµĞ²Ğ¸Ğ´Ğ½Ñ‹Ğ¼Ğ¸?",
      q4_sub: "ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ¾Ğ².",
      ht1: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 1",
      ht2: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 2",
      ht3: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 3",
      ht4: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 4",
      ht5: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 5",
      ht6: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 6",
      ht7: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 7",
      ht8: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 8",
      ht9: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 9",
      hard_note: "(â€œĞ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 1â€¦9â€ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¿Ğ¾Ñ‚Ğ¾Ğ¼ Ğ¿ĞµÑ€ĞµĞ¸Ğ¼ĞµĞ½Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ.)",

      q5_title: "ĞÑ†ĞµĞ½Ğ¸Ñ‚Ğµ ĞºĞ°Ğ¶Ğ´Ğ¾Ğµ Ğ¸Ğ· 9 Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹",
      q5_sub: "1 â€” Ğ½Ğµ Ğ¿Ğ¾Ğ½Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ¾ÑÑŒ / 5 â€” Ğ¾Ñ‡ĞµĞ½ÑŒ Ğ¿Ğ¾Ğ½Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ¾ÑÑŒ",
      t1: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 1",
      t2: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 2",
      t3: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 3",
      t4: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 4",
      t5: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 5",
      t6: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 6",
      t7: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 7",
      t8: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 8",
      t9: "Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 9",

      q6_title: "Ğ‘Ñ‹Ğ» Ğ»Ğ¸ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚, ĞºĞ¾Ğ³Ğ´Ğ° Ğ²Ñ‹ ÑƒÑÑ‚Ğ°Ğ»Ğ¸ Ğ¸Ğ»Ğ¸ Ğ¿Ğ¾Ñ‚ĞµÑ€ÑĞ»Ğ¸ Ñ„Ğ¾ĞºÑƒÑ?",
      fa1: "ĞĞµÑ‚ â€” Ğ²ÑÑ‘ Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ¾ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡Ğ½Ğ¾",
      fa2: "Ğ”Ğ° â€” Ğ±Ğ»Ğ¸Ğ¶Ğµ Ğº ÑĞµÑ€ĞµĞ´Ğ¸Ğ½Ğµ",
      fa3: "Ğ”Ğ° â€” Ğ±Ğ»Ğ¸Ğ¶Ğµ Ğº ĞºĞ¾Ğ½Ñ†Ñƒ",

      q7_title: "Ğ’Ğ°Ñˆ Ğ»ÑĞ±Ğ¸Ğ¼Ñ‹Ğ¹ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ ĞºĞ²ĞµÑÑ‚Ğ°",
      ph_fav: "ĞšĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ°Ñ ÑÑ†ĞµĞ½Ğ°, ÑĞ¼ĞµÑˆĞ½Ğ¾Ğ¹ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚, Ğ¼ĞµÑÑ‚Ğ¾, Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ â€” Ñ‡Ñ‚Ğ¾ ÑƒĞ³Ğ¾Ğ´Ğ½Ğ¾.",

      q8_title: "Ğ§Ñ‚Ğ¾ Ğ±Ñ‹ Ğ²Ñ‹ ÑƒĞ»ÑƒÑ‡ÑˆĞ¸Ğ»Ğ¸ Ğ¸Ğ»Ğ¸ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ğ»Ğ¸ Ğ² ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ñ€Ğ°Ğ·?",
      ph_improve: "Ğ‘ÑƒĞ´ÑŒÑ‚Ğµ Ñ‡ĞµÑÑ‚Ğ½Ñ‹Ğ¼Ğ¸ â€” ÑÑ‚Ğ¾ ÑĞ°Ğ¼Ğ¾Ğµ Ñ†ĞµĞ½Ğ½Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ ğŸ™‚",

      q9_title: "ĞÑ‚Ğ·Ñ‹Ğ² Ğ´Ğ»Ñ Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ (Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğ¹)",
      pub_note: "Ğ’Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ 1â€“8 Ğ¼Ñ‹ ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ğ´Ğ»Ñ Ğ²Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½ĞµĞ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ¸ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ñ… ĞºĞ²ĞµÑÑ‚Ğ¾Ğ². Ğ’Ğ¾Ğ¿Ñ€Ğ¾Ñ 9 â€” Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹: ÑÑ‚Ğ¾ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğ¹ Ğ¾Ñ‚Ğ·Ñ‹Ğ², ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¼Ñ‹ Ğ¼Ğ¾Ğ¶ĞµĞ¼ Ğ¾Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ° Ğ½Ğ°ÑˆĞ¸Ñ… Ñ€ĞµÑÑƒÑ€ÑĞ°Ñ….",
      q_public: "ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ Ñ‡ĞµÑÑ‚Ğ½Ñ‹Ğ¹ Ğ¾Ğ±Ñ‰Ğ¸Ğ¹ Ğ¾Ñ‚Ğ·Ñ‹Ğ² Ğ´Ğ»Ñ Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸",
      ph_public: "Ğ¢Ğ°Ğº, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ Ğ»ÑĞ´Ğ¸, Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ğ² ĞµĞ³Ğ¾, Ğ¼Ğ¾Ğ³Ğ»Ğ¸ Ğ¿Ğ¾Ğ½ÑÑ‚ÑŒ Ğ²Ğ¿ĞµÑ‡Ğ°Ñ‚Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾ ĞºĞ²ĞµÑÑ‚Ğµ.",

      send: "ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ"
    }
  };

  function applyLang(lang) {
    langInput.value = lang;

    document.querySelectorAll('[data-i18n]').forEach(el => {
      const key = el.getAttribute('data-i18n');
      if (dict[lang][key]) el.textContent = dict[lang][key];
    });

    document.querySelectorAll('[data-i18n-ph]').forEach(el => {
      const key = el.getAttribute('data-i18n-ph');
      if (dict[lang][key]) el.setAttribute('placeholder', dict[lang][key]);
    });

    document.getElementById('btnEN').classList.toggle('active', lang === 'en');
    document.getElementById('btnRU').classList.toggle('active', lang === 'ru');
  }

  document.getElementById('btnEN').addEventListener('click', () => applyLang('en'));
  document.getElementById('btnRU').addEventListener('click', () => applyLang('ru'));
  applyLang('en');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    msg.textContent = '';
    msg.className = '';
    btn.disabled = true;

    document.getElementById('device_time').value = new Date().toISOString();
    document.getElementById('source_page').value = location.href;

    const data = new URLSearchParams();
    data.set('lang', langInput.value);
    data.set('device_time', document.getElementById('device_time').value);
    data.set('source_page', document.getElementById('source_page').value);

    data.set('overall_10', form.overall_10.value);
    data.set('liked_most', collectChecked('liked_most_opt'));
    data.set('add_types', collectChecked('add_types_opt'));
    data.set('hard_tasks', collectChecked('hard_tasks_opt'));

    data.set('task1_rating', form.task1_rating.value);
    data.set('task2_rating', form.task2_rating.value);
    data.set('task3_rating', form.task3_rating.value);
    data.set('task4_rating', form.task4_rating.value);
    data.set('task5_rating', form.task5_rating.value);
    data.set('task6_rating', form.task6_rating.value);
    data.set('task7_rating', form.task7_rating.value);
    data.set('task8_rating', form.task8_rating.value);
    data.set('task9_rating', form.task9_rating.value);

    data.set('fatigue', form.fatigue.value);
    data.set('favorite_moment', form.favorite_moment.value.trim());
    data.set('improve', form.improve.value.trim());
    data.set('public_review', form.public_review.value.trim());

    try {
      await fetch(API_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },
        body: data.toString()
      });

      msg.textContent = (langInput.value === 'ru')
        ? 'Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾! ğŸ™Œ ĞÑ‚Ğ·Ñ‹Ğ² Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½.'
        : 'Thank you! ğŸ™Œ Your feedback was sent.';
      msg.className = 'ok';

      form.reset();
      applyLang(langInput.value);
    } catch (err) {
      msg.textContent = (langInput.value === 'ru')
        ? 'ĞÑˆĞ¸Ğ±ĞºĞ°: Ğ½Ğµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ĞµÑ‰Ñ‘ Ñ€Ğ°Ğ·.'
        : 'Error: could not send. Please try again.';
      msg.className = 'err';
      console.error(err);
    } finally {
      btn.disabled = false;
    }
  });
</script>
</body>
</html>
