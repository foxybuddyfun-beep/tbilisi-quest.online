<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tbilisi City Quest ‚Äî Feedback</title>
  <style>
    body{font-family:system-ui,Arial;margin:0;background:#f6f7fb;color:#111827}
    .wrap{max-width:980px;margin:0 auto;padding:20px}
    .card{background:#fff;border-radius:16px;padding:18px;box-shadow:0 6px 24px rgba(0,0,0,.06);margin-bottom:14px}
    h1{margin:0 0 6px;font-size:22px}
    .muted{color:#667085;font-size:14px;line-height:1.45}
    h2{margin:18px 0 10px;font-size:18px}
    label{display:block;margin:10px 0 6px;font-weight:600}
    input[type="text"], textarea, select{
      width:100%;box-sizing:border-box;border:1px solid #d0d5dd;border-radius:12px;
      padding:10px 12px;font-size:15px;background:#fff
    }
    textarea{min-height:90px;resize:vertical}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .col{flex:1;min-width:240px}
    .options{display:flex;flex-direction:column;gap:8px;margin-top:8px}
    .opt{display:flex;gap:10px;align-items:flex-start}
    .opt input{margin-top:3px}
    .hr{height:1px;background:#eef2f6;margin:16px 0}
    .btn{
      display:inline-block;background:#111827;color:#fff;border:0;border-radius:12px;
      padding:10px 14px;font-size:15px;cursor:pointer
    }
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .ok{color:#16a34a;font-weight:700;margin-top:10px}
    .err{color:#dc2626;font-weight:700;margin-top:10px}
    .small{font-size:13px;color:#667085}
    .langbar{display:flex;gap:10px;align-items:center;justify-content:space-between}
    .langbtns{display:flex;gap:8px}
    .chip{
      border:1px solid #d0d5dd;background:#fff;border-radius:999px;padding:8px 12px;
      font-size:14px;cursor:pointer
    }
    .chip.active{background:#111827;color:#fff;border-color:#111827}
    a{color:#111827}
  </style>
</head>
<body>
  <div class="wrap">

    <!-- Header / Intro -->
    <div class="card">
      <div class="langbar">
        <div>
          <h1 data-i18n="title">Tbilisi City Quest ‚Äî Feedback</h1>
          <div class="muted" data-i18n="intro">
            Thank you for joining the quest! I‚Äôm David, the organizer.
            This feedback helps me improve the next quests.
          </div>
        </div>
        <div class="langbtns">
          <button type="button" class="chip active" id="btnEN">EN</button>
          <button type="button" class="chip" id="btnRU">RU</button>
        </div>
      </div>

      <div class="hr"></div>

      <div class="muted" data-i18n="bonus">
        I‚Äôm also sharing the photos from the Bonus Points locations here:
        <span class="small">(Google Drive folder)</span>
      </div>
      <div style="margin-top:8px">
        <a href="https://drive.google.com/drive/folders/19heIL2brz2fOwoCunBCAbF-lrwKZyYnd?usp=sharing"
           target="_blank" rel="noopener noreferrer"
           data-i18n="bonus_link">Open the Bonus Photos folder</a>
      </div>

      <div class="hr"></div>

      <div class="muted" data-i18n="timehint">
        This form takes ~5‚Äì7 minutes. Please answer honestly ‚Äî it really helps üôå
      </div>
    </div>

    <!-- Form -->
    <form id="feedbackForm" class="card">
      <!-- hidden meta -->
      <input type="hidden" name="lang" id="lang" value="en" />
      <input type="hidden" name="device_time" id="device_time" value="" />
      <input type="hidden" name="source_page" id="source_page" value="" />

      <!-- Team -->
      <h2 data-i18n="sec_team">Team</h2>

      <label for="team_name" data-i18n="team_label">Team name *</label>
      <select id="team_name" name="team_name" required>
        <option value="" data-i18n="select">Select</option>
        <option value="Eggplants">Eggplants</option>
        <option value="Singulanities">Singulanities</option>
        <option value="NDA">NDA</option>
      </select>

      <div class="hr"></div>

      <!-- 1Ô∏è‚É£ Overall -->
      <h2 data-i18n="sec1">1Ô∏è‚É£ Overall experience</h2>

      <label for="overall_rating" data-i18n="q_overall">How did you like the Tbilisi City Quest? *</label>
      <select id="overall_rating" name="overall_rating" required>
        <option value="" data-i18n="select">Select</option>
        <option value="5" data-i18n="r5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Loved it</option>
        <option value="4" data-i18n="r4">‚≠ê‚≠ê‚≠ê‚≠ê Liked it</option>
        <option value="3" data-i18n="r3">‚≠ê‚≠ê‚≠ê Okay</option>
        <option value="2" data-i18n="r2">‚≠ê‚≠ê Mostly not</option>
        <option value="1" data-i18n="r1">‚≠ê Did not like</option>
      </select>

      <label data-i18n="q_feelings">What best describes your feelings? (choose up to 2)</label>
      <div class="options" data-limit="2">
        <label class="opt"><input type="checkbox" name="feelings_opt" value="Interesting & intellectual"><span data-i18n="f1">Interesting & intellectual</span></label>
        <label class="opt"><input type="checkbox" name="feelings_opt" value="Fun & light"><span data-i18n="f2">Fun & light</span></label>
        <label class="opt"><input type="checkbox" name="feelings_opt" value="Great way to explore the city"><span data-i18n="f3">Great way to explore the city</span></label>
        <label class="opt"><input type="checkbox" name="feelings_opt" value="Team bonding"><span data-i18n="f4">Team bonding</span></label>
        <label class="opt"><input type="checkbox" name="feelings_opt" value="Unexpected & creative"><span data-i18n="f5">Unexpected & creative</span></label>
      </div>

      <div class="hr"></div>

      <!-- 2Ô∏è‚É£ Tasks & route -->
      <h2 data-i18n="sec2">2Ô∏è‚É£ Tasks and route</h2>

      <label data-i18n="q_tasktypes">What type of tasks did you like the most?</label>
      <div class="options">
        <label class="opt"><input type="checkbox" name="liked_task_types_opt" value="Monuments & visual clues"><span data-i18n="t1">Monuments & visual clues</span></label>
        <label class="opt"><input type="checkbox" name="liked_task_types_opt" value="Logic puzzles"><span data-i18n="t2">Logic puzzles</span></label>
        <label class="opt"><input type="checkbox" name="liked_task_types_opt" value="Culture & stories"><span data-i18n="t3">Culture & stories</span></label>
        <label class="opt"><input type="checkbox" name="liked_task_types_opt" value="Attention & associations"><span data-i18n="t4">Attention & associations</span></label>
        <label class="opt"><input type="checkbox" name="liked_task_types_opt" value="Photo challenge (Bonus Points)"><span data-i18n="t5">Photo challenge (Bonus Points)</span></label>
      </div>

      <label for="hard_tasks" data-i18n="q_hard">Were any tasks too hard or unclear? If yes ‚Äî which ones?</label>
      <textarea id="hard_tasks" name="hard_tasks" data-i18n-ph="ph_hard" placeholder="Example: The Gurji bird clue was confusing; the Canyon DNA of Love felt too open-ended..."></textarea>

      <div class="hr"></div>

      <!-- 3Ô∏è‚É£ Guide & format -->
      <h2 data-i18n="sec3">3Ô∏è‚É£ Format and support</h2>

      <label for="guide_rating" data-i18n="q_guide">How do you rate the team support during the quest? (1‚Äì5)</label>
      <select id="guide_rating" name="guide_rating">
        <option value="" data-i18n="select">Select</option>
        <option value="5" data-i18n="g5">5 ‚Äî Excellent</option>
        <option value="4" data-i18n="g4">4 ‚Äî Good</option>
        <option value="3" data-i18n="g3">3 ‚Äî Okay</option>
        <option value="2" data-i18n="g2">2 ‚Äî Weak</option>
        <option value="1" data-i18n="g1">1 ‚Äî Poor</option>
      </select>

      <label data-i18n="q_helped">What helped you most during the quest?</label>
      <div class="options">
        <label class="opt"><input type="checkbox" name="helpful_factors_opt" value="Hints and guidance"><span data-i18n="h1">Hints and guidance</span></label>
        <label class="opt"><input type="checkbox" name="helpful_factors_opt" value="Task structure"><span data-i18n="h2">Task structure</span></label>
        <label class="opt"><input type="checkbox" name="helpful_factors_opt" value="Teamwork"><span data-i18n="h3">Teamwork</span></label>
        <label class="opt"><input type="checkbox" name="helpful_factors_opt" value="Game atmosphere"><span data-i18n="h4">Game atmosphere</span></label>
      </div>

      <div class="hr"></div>

      <!-- 4Ô∏è‚É£ Improv in hotel -->
      <h2 data-i18n="sec4">4Ô∏è‚É£ Improv warm-up at the hotel</h2>

      <label for="improv_overall" data-i18n="q_improv">How did you like the improv game (posing as Pirosmani paintings)?</label>
      <select id="improv_overall" name="improv_overall">
        <option value="" data-i18n="select">Select</option>
        <option value="üî• Loved it ‚Äî started the quest with energy" data-i18n="i1">üî• Loved it ‚Äî started the quest with energy</option>
        <option value="üôÇ Liked it" data-i18n="i2">üôÇ Liked it</option>
        <option value="ü§î Not fully understood" data-i18n="i3">ü§î Not fully understood</option>
        <option value="üôÉ Not my format" data-i18n="i4">üôÉ Not my format</option>
      </select>

      <label for="improv_warmup_rating" data-i18n="q_warmup">How much did it help you ‚Äúwarm up‚Äù before the quest? (1‚Äì5)</label>
      <select id="improv_warmup_rating" name="improv_warmup_rating">
        <option value="" data-i18n="select">Select</option>
        <option value="5" data-i18n="w5">5 ‚Äî A lot</option>
        <option value="4" data-i18n="w4">4</option>
        <option value="3" data-i18n="w3">3</option>
        <option value="2" data-i18n="w2">2</option>
        <option value="1" data-i18n="w1">1 ‚Äî Not at all</option>
      </select>

      <div class="hr"></div>

      <!-- 5Ô∏è‚É£ Timing -->
      <h2 data-i18n="sec5">5Ô∏è‚É£ Timing and energy</h2>

      <label for="duration" data-i18n="q_duration">How was the quest duration?</label>
      <select id="duration" name="duration">
        <option value="" data-i18n="select">Select</option>
        <option value="Perfect" data-i18n="d1">‚è± Perfect</option>
        <option value="Could be shorter" data-i18n="d2">‚è≥ Could be shorter</option>
        <option value="Would like longer" data-i18n="d3">üï∞ Would like longer</option>
      </select>

      <label for="fatigue" data-i18n="q_fatigue">Did you feel tired or lose focus at any point?</label>
      <select id="fatigue" name="fatigue">
        <option value="" data-i18n="select">Select</option>
        <option value="No ‚Äî it stayed dynamic" data-i18n="fa1">No ‚Äî it stayed dynamic</option>
        <option value="Yes ‚Äî around the middle" data-i18n="fa2">Yes ‚Äî around the middle</option>
        <option value="Yes ‚Äî closer to the end" data-i18n="fa3">Yes ‚Äî closer to the end</option>
      </select>

      <div class="hr"></div>

      <!-- 6Ô∏è‚É£ Team effect -->
      <h2 data-i18n="sec6">6Ô∏è‚É£ Team effect</h2>

      <label data-i18n="q_team">How did the quest affect your team?</label>
      <div class="options">
        <label class="opt"><input type="checkbox" name="team_effect_opt" value="We communicated more"><span data-i18n="te1">We communicated more</span></label>
        <label class="opt"><input type="checkbox" name="team_effect_opt" value="More jokes and lightness appeared"><span data-i18n="te2">More jokes and lightness appeared</span></label>
        <label class="opt"><input type="checkbox" name="team_effect_opt" value="I saw colleagues from a new side"><span data-i18n="te3">I saw colleagues from a new side</span></label>
        <label class="opt"><input type="checkbox" name="team_effect_opt" value="No change"><span data-i18n="te4">No change</span></label>
      </div>

      <label for="favorite_moment" data-i18n="q_fav">Your favorite moment of the quest</label>
      <textarea id="favorite_moment" name="favorite_moment" data-i18n-ph="ph_fav" placeholder="A specific scene, a funny moment, a place, a task, anything."></textarea>

      <div class="hr"></div>

      <!-- 7Ô∏è‚É£ Recommendation -->
      <h2 data-i18n="sec7">7Ô∏è‚É£ Final: recommendation and improvements</h2>

      <label for="recommend" data-i18n="q_rec">Would you recommend this team-building format to other teams?</label>
      <select id="recommend" name="recommend">
        <option value="" data-i18n="select">Select</option>
        <option value="Yes, definitely" data-i18n="rec1">Yes, definitely</option>
        <option value="Probably yes" data-i18n="rec2">Probably yes</option>
        <option value="Probably no" data-i18n="rec3">Probably no</option>
        <option value="No" data-i18n="rec4">No</option>
      </select>

      <label for="improve" data-i18n="q_improve">What should we improve or add next time?</label>
      <textarea id="improve" name="improve" data-i18n-ph="ph_improve" placeholder="Be brutally honest ‚Äî this is the most valuable field üôÇ"></textarea>

      <div class="hr"></div>

      <!-- 8Ô∏è‚É£ Public review -->
      <h2 data-i18n="sec8">8Ô∏è‚É£ Public review (anonymous)</h2>

      <div class="muted" data-i18n="sec8_note">
        Questions 1‚Äì7 are collected for internal analysis and improving future quests.
        Question 8 is different: it is an anonymous review that we may publish on our resources.
      </div>

      <label for="public_review" data-i18n="q_public_review">
        Please write an honest, general review that helps other people understand what the quest feels like.
      </label>
      <textarea id="public_review" name="public_review" data-i18n-ph="ph_public_review"
        placeholder="2‚Äì6 sentences. What was it like? What stood out? Who would enjoy it?"></textarea>

      <div class="hr"></div>

      <button class="btn" id="submitBtn" type="submit" data-i18n="send">Send feedback</button>
      <div id="msg"></div>
    </form>
  </div>

  <script>
    // 1) Paste your Google Apps Script Web App URL here
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwjXNGZMkmLTcNI-psAfJQtmgfDRoMhCRPwXS-S3Q5xY9F9vwiSEKs3FNh758CjD_aM/exec";

    const form = document.getElementById('feedbackForm');
    const msg = document.getElementById('msg');
    const btn = document.getElementById('submitBtn');
    const langInput = document.getElementById('lang');

    // Meta
    document.getElementById('device_time').value = new Date().toISOString();
    document.getElementById('source_page').value = location.href;

    function collectChecked(name) {
      const nodes = form.querySelectorAll(`input[name="${name}"]:checked`);
      return Array.from(nodes).map(n => n.value).join("; ");
    }

    // Limit feelings to 2
    (function limitFeelingsTo2(){
      const boxWrap = form.querySelector('.options[data-limit="2"]');
      if (!boxWrap) return;
      const boxes = boxWrap.querySelectorAll('input[type="checkbox"][name="feelings_opt"]');
      boxes.forEach(b => {
        b.addEventListener('change', () => {
          const checked = boxWrap.querySelectorAll('input[name="feelings_opt"]:checked');
          if (checked.length > 2) b.checked = false;
        });
      });
    })();

    // i18n
    const dict = {
      en: {
        title: "Tbilisi City Quest ‚Äî Feedback",
        intro: "Thank you for joining the quest! I‚Äôm David, the organizer. This feedback helps me improve the next quests.",
        bonus: "I‚Äôm also sharing the photos from the Bonus Points locations here: (Google Drive folder)",
        bonus_link: "Open the Bonus Photos folder",
        timehint: "This form takes ~5‚Äì7 minutes. Please answer honestly ‚Äî it really helps üôå",

        sec_team: "Team",
        team_label: "Team name *",
        select: "Select",

        sec1: "1Ô∏è‚É£ Overall experience",
        q_overall: "How did you like the Tbilisi City Quest? *",
        r5: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Loved it",
        r4: "‚≠ê‚≠ê‚≠ê‚≠ê Liked it",
        r3: "‚≠ê‚≠ê‚≠ê Okay",
        r2: "‚≠ê‚≠ê Mostly not",
        r1: "‚≠ê Did not like",
        q_feelings: "What best describes your feelings? (choose up to 2)",
        f1: "Interesting & intellectual",
        f2: "Fun & light",
        f3: "Great way to explore the city",
        f4: "Team bonding",
        f5: "Unexpected & creative",

        sec2: "2Ô∏è‚É£ Tasks and route",
        q_tasktypes: "What type of tasks did you like the most?",
        t1: "Monuments & visual clues",
        t2: "Logic puzzles",
        t3: "Culture & stories",
        t4: "Attention & associations",
        t5: "Photo challenge (Bonus Points)",
        q_hard: "Were any tasks too hard or unclear? If yes ‚Äî which ones?",
        ph_hard: "Example: The Gurji bird clue was confusing; the Canyon DNA of Love felt too open-ended...",

        sec3: "3Ô∏è‚É£ Format and support",
        q_guide: "How do you rate the team support during the quest? (1‚Äì5)",
        g5: "5 ‚Äî Excellent",
        g4: "4 ‚Äî Good",
        g3: "3 ‚Äî Okay",
        g2: "2 ‚Äî Weak",
        g1: "1 ‚Äî Poor",
        q_helped: "What helped you most during the quest?",
        h1: "Hints and guidance",
        h2: "Task structure",
        h3: "Teamwork",
        h4: "Game atmosphere",

        sec4: "4Ô∏è‚É£ Improv warm-up at the hotel",
        q_improv: "How did you like the improv game (posing as Pirosmani paintings)?",
        i1: "üî• Loved it ‚Äî started the quest with energy",
        i2: "üôÇ Liked it",
        i3: "ü§î Not fully understood",
        i4: "üôÉ Not my format",
        q_warmup: "How much did it help you ‚Äúwarm up‚Äù before the quest? (1‚Äì5)",
        w5: "5 ‚Äî A lot",
        w4: "4",
        w3: "3",
